import openai
import os
from dotenv import load_dotenv

# .env νμΌ λ΅λ“
load_dotenv()

# OpenAI API ν‚¤ μ„¤μ •
api_key = os.getenv("OPENAI_API_KEY")

# OpenAI ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™” (μµμ‹  λ°©μ‹)
client = openai.OpenAI(api_key=api_key)

def summarize_text(input_text):
    """ OpenAI GPT-4o λ¨λΈμ„ μ‚¬μ©ν•μ—¬ Generalν• μΈν…λ¦¬μ–΄ μƒλ‹΄ λ³΄κ³ μ„ ν•μ‹μΌλ΅ μ”μ•½ """
    try:
        response = client.chat.completions.create(
            model="gpt-4o",
            messages=[
                {"role": "system", "content": 
                    "μ£Όμ–΄μ§„ μΈν…λ¦¬μ–΄ μƒλ‹΄ λ‚΄μ©μ„ λ‹¤μ ν•μ‹μΌλ΅ μ •λ¦¬ν•΄μ¤. "
                    "μ΄ ν¬λ§·μ€ μ΄κΈ° κ²¬μ  μƒλ‹΄κ³Ό κ³„μ•½ ν›„ μƒλ‹΄ λ¨λ‘λ¥Ό ν¬ν•¨ν•  μ μλ„λ΅ μ„¤κ³„λμ—μ–΄.\n\n"
                    "π“ 1. κΈ°λ³Έ μ •λ³΄\n"
                    "- κ³ κ° μ΄λ¦„: (κ³ κ° μ΄λ¦„)\n"
                    "- μ—°λ½μ²: (μ—°λ½μ²)\n"
                    "- μƒλ‹΄ μΌμ: (μƒλ‹΄ λ‚ μ§)\n"
                    "- μƒλ‹΄ μ ν•: (μ΄κΈ° κ²¬μ  μƒλ‹΄ / κ³„μ•½ ν›„ μƒμ„Έ ν‘μ / μ¶”κ°€ μ”μ²­ / λ¬Έμ  ν•΄κ²° λ“±)\n"
                    "- μƒλ‹΄ μ¥μ†: (μ¤ν”„λΌμΈ λ―Έν… / μ „ν™” μƒλ‹΄ / μ¨λΌμΈ νμ λ“±)\n\n"
                    "π“ 2. μƒλ‹΄ κ°μ”\n"
                    "- μ£Όμ” λ…Όμ μ‚¬ν•­: (ν•µμ‹¬ λ‚΄μ© μ”μ•½)\n"
                    "- κ³ κ°μ μ£Όμ” κ΄€μ‹¬μ‚¬: (μμ‚°, λ””μμΈ μ¤νƒ€μΌ, κΈ°λ¥ λ“±)\n"
                    "- ν„μ¬ μ§„ν–‰ μƒνƒ: (κ³„μ•½ μ „ / κ³„μ•½ ν›„ / κ³µμ‚¬ μ§„ν–‰ μ¤‘ / μ¶”κ°€ μ”μ²­ λ“±)\n"
                    "- κΈ°ν• λ° μΌμ • μ΅°μ¨: (μ™„κ³µ ν¬λ§ μ‹κΈ°, μ¤‘κ°„ μ κ²€ μΌμ • λ“±)\n\n"
                    "π“ 3. μƒμ„Έ μ”μ²­ λ‚΄μ©\n"
                    "β… κ±°μ‹¤\n"
                    "- (κ±°μ‹¤ κ΄€λ ¨ μ”μ²­ μ •λ¦¬)\n"
                    "β… μ£Όλ°©\n"
                    "- (μ£Όλ°© κ΄€λ ¨ μ”μ²­ μ •λ¦¬)\n"
                    "β… κΈ°νƒ€ κ³µκ°„ (μ•μ‹¤, μΉ¨μ‹¤ λ“±)\n"
                    "- (κΈ°νƒ€ κ³µκ°„ κ΄€λ ¨ μ”μ²­ μ •λ¦¬)\n\n"
                    "π“ 4. μ¶”κ°€ μ”μ²­ / λ³€κ²½ μ‚¬ν•­\n"
                    "- (κ³ κ°μ΄ μ¶”κ°€ μ”μ²­ν• μ‚¬ν•­)\n"
                    "- (κΈ°μ΅΄ κ³„μ•½ λ€λΉ„ λ³€κ²½λ λ‚΄μ©)\n"
                    "- (νΉμ΄ μ‚¬ν•­ - μμ‚° λ³€κ²½, μΌμ • μ΅°μ • λ“±)\n\n"
                    "π“ 5. ν•΄κ²°ν•΄μ•Ό ν•  λ¬Έμ  & λ‹¤μ λ‹¨κ³„\n"
                    "- ν•΄κ²°μ΄ ν•„μ”ν• μ΄μ (μ: μμ¬ λ³€κ²½, λ””μμΈ μ΅°μ¨, μμ‚° μ΄κ³Ό λ“±)\n"
                    "- λ‹¤μ λ‹¨κ³„ μ§„ν–‰ κ³„ν\n"
                    "- κ³ κ° ν”Όλ“λ°± λ°μ μ‚¬ν•­\n"},
                {"role": "user", "content": input_text}
            ]
        )
        return response.choices[0].message.content
    except Exception as e:
        print(f"β μ”μ•½ μ¤λ¥: {e}")
        return "μ”μ•½ μ‹¤ν¨"
