import openai
import os
from dotenv import load_dotenv

# .env νμΌ λ΅λ“
load_dotenv()

# OpenAI API ν‚¤ μ„¤μ •
api_key = os.getenv("OPENAI_API_KEY")

# OpenAI ν΄λΌμ΄μ–ΈνΈ μ΄κΈ°ν™”
client = openai.OpenAI(api_key=api_key)

def summarize_text(input_text):
    """ OpenAI GPT-4o λ¨λΈμ„ μ‚¬μ©ν•μ—¬ μƒλ‹΄ λ‚΄μ©μ„ μ²΄κ³„μ μΌλ΅ μ”μ•½ν•λ” ν•¨μ """
    try:
        response = client.chat.completions.create(
            model="gpt-4o",
            messages=[
                {"role": "system", "content": 
                    "μ£Όμ–΄μ§„ μƒλ‹΄ λ‚΄μ©μ„ λ…Όλ¦¬μ μΌλ΅ μ •λ¦¬ν•κ³ , μ„Έμ„Έν• λ‚΄μ©μ„ λΉ μ§μ—†μ΄ μ”μ•½ν•΄μ¤. "
                    "λ€ν™” λ‚΄μ©μ΄ νΌλ€μ¤λ½κ±°λ‚ μ—¬λ¬ μ£Όμ λ¥Ό ν¬ν•¨ν•κ³  μμ–΄λ„, ν•µμ‹¬ λ‚΄μ©μ„ μ°Ύμ•„ κµ¬μ΅°ν™”λ μ”μ•½μ„ μ κ³µν•΄μ•Ό ν•΄.\n\n"

                    "π’΅ **μ”μ•½ κ·μΉ™**\n"
                    "- μƒλ‹΄ λ‚΄μ©μ΄ λ§μΌλ©΄ μλ™μΌλ΅ μΉ΄ν…κ³ λ¦¬λ¥Ό λ§λ“¤μ–΄ λ¶„λ¥ν•  κ²ƒ.\n"
                    "- μμΉ(κΈμ•΅, μΌμ • λ“±)λ” λ°λ“μ‹ ν¬ν•¨ν•μ—¬ κΈ°λ΅ν•  κ²ƒ.\n"
                    "- κ³ κ°μ΄ μ¤‘μ”ν•κ² μ—¬κΈ°λ” λ¶€λ¶„μ„ κ°•μ΅°ν•μ—¬ ν‘μ‹ν•  κ²ƒ.\n"
                    "- λ‚΄μ©μ΄ λ§μ•„λ„ λ…ν™•ν•κ³  μ²΄κ³„μ μΌλ΅ μ •λ¦¬ν•  κ²ƒ.\n\n"

                    "π“ **μ”μ•½ ν•μ‹**\n"
                    "1. **μƒλ‹΄ κ°μ”** (3~5μ¤„ μ”μ•½)\n"
                    "2. **μ„Έλ¶€ λ‚΄μ© μ •λ¦¬** (ν•­λ©λ³„ μ •λ¦¬, μ„Έλ¶€ μ‚¬ν•­ ν¬ν•¨)\n"
                    "3. **μ¤‘μ” μΌμ • λ° κΈμ•΅ μ •λ¦¬** (ν•΄λ‹Ή λ‚΄μ©μ΄ μμ„ κ²½μ° λ³„λ„ μ •λ¦¬)\n\n"

                    "β… **μμ‹**\n"
                    "### **1. μƒλ‹΄ κ°μ”**\n"
                    "- κ³ κ°μ΄ κΈ°μ΅΄ κ±°μ£Ό κ³µκ°„μ„ λ¶€λ¶„ λ¦¬λ¨λΈλ§ν•λ ¤κ³  μƒλ‹΄.\n"
                    "- μ£Όλ°©, κ±°μ‹¤, μ•μ‹¤ κ°μ„  λ° μ°½νΈ κµμ²΄ κ΄€λ ¨ λ…Όμ.\n"
                    "- κ°•μ•„μ§€ κ΄€λ¦¬, μ΅μ•„ λ¶€λ‹΄, κ°€μ‚¬ λ„μ°λ―Έ ν™μ©λ„ ν•¨κ» λ…Όμλ¨.\n\n"

                    "### **2. μ„Έλ¶€ λ‚΄μ© μ •λ¦¬**\n"
                    "**1. μΈν…λ¦¬μ–΄ λ° κ³µμ‚¬**\n"
                    "- μ£Όλ°©: μ‹±ν¬λ€ κµμ²΄ μ—¬λ¶€ λ…Όμ (LG μ ν’ vs ν•μƒ)\n"
                    "- μ•μ‹¤: λ€λ¦Ό λ°”μ¤ μ ν’ κ²€ν† , μ›°μ¤ μ½”ν… μ¶”κ°€ κ°€λ¥μ„± κ²€ν† \n"
                    "- μ°½νΈ: κΈ°μ΅΄ μ—μ§€ 246mm μƒ¤μ‹ λ€μ²΄ κ°€λ¥ μ—¬λ¶€ ν™•μΈ ν•„μ”\n"
                    "- λ°λ”© μ—†λ” μ‹¬ν” λ””μμΈ μ„ νΈ, λ„μ¥ λ§κ° vs ν•„λ¦„ λ§κ° λ…Όμ\n\n"

                    "**2. κ°•μ•„μ§€ κ΄€λ¦¬**\n"
                    "- ν„Έ λΉ μ§ λ¬Έμ λ΅ μλ™ μ²­μ†κΈ° μ‚¬μ© κ²€ν† \n"
                    "- ν•λ£¨ 3ν μ‚°μ±… (μ•„μΉ¨, μ μ‹¬, μ €λ…) ν¨ν„΄ μ μ§€\n\n"

                    "**3. μ΅μ•„ λ° κ°€μ‚¬ λ¶€λ‹΄**\n"
                    "- λ§λ²μ΄ λ¶€λ¶€λ΅ μΈν•΄ κ°€μ‚¬ λ„μ°λ―Έ ν™μ© (μ£Ό 2~3ν λ°©λ¬Έ)\n"
                    "- μ •λ¶€ μ§€μ› κ°€μ‚¬ λ„μ°λ―Έ ν”„λ΅κ·Έλ¨ μ—¬λ¶€ λ…Όμ\n\n"

                    "### **3. μ¤‘μ” μΌμ • λ° κΈμ•΅ μ •λ¦¬**\n"
                    "- κ³µμ‚¬ μΌμ •: 5μ›” 6μΌ λλ” 5μ›” 15μΌ μ¤‘ μ„ νƒ μμ •\n"
                    "- μμƒ λΉ„μ©: μƒ¤μ‹ κµμ²΄ 320λ§ μ›, μ•μ‹¤ κ°μ„  180λ§ μ›\n"
                    "(VAT ν¬ν•¨ μ΄ 500λ§ μ› μμƒ)\n"
                    "...\n"
                    "(μ„μ™€ κ°™μ€ λ°©μ‹μΌλ΅ μƒλ‹΄ λ‚΄μ©μ„ μ„Έλ¶€μ μΌλ΅ μ •λ¦¬ν•  κ²ƒ.)"
                },
                {"role": "user", "content": input_text}
            ]
        )
        return response.choices[0].message.content
    except Exception as e:
        print(f"β μ”μ•½ μ¤λ¥ λ°μƒ: {e}")
        return "μ”μ•½ μ‹¤ν¨"